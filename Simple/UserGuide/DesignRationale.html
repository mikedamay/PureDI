<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />    
    <title>Some Title</title>
    <link type="text/png" rel="icon" href="/glyphicons_free/glyphicons/png/glyphicons-30-notes-2.png" />
    <link type="text/css" href="/Simple/Content/bootstrap-3.3.7/css/bootstrap.css" rel="stylesheet"/>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-sm-1"></div>
        <div class="col-sm-10">
            <h3 class="col-sm-10" style="color: blue">Design Rationale</h3>
            <!--<hr class="col-xs-12"/>-->
        </div>
        <div class="col-sm-1"></div>
    </div>
    <div class="row">
        <div class="col-sm-1"></div>
        <div class="col-sm-10">
            <p>Three aspirations underly the design of the container:</p>
<ul>
<li>Simplicity</li>
<li>Transparency</li>
<li>Verifiability</li>
</ul>
<h4>Simplicity</h4>
<p>In the interests of simplicity the libraries surface area is restricted to:</p>
<ul>
<li>A single significant operational class <code>PDependencyInjector</code> coupled with 3 enums</li>
<li>A single constructor for the container and a single
method <code>CreateAndInjectDependencies</code> albeit with 4 overloads</li>
<li>The Diagnostics class and its components which for most purposes can be
ignored except to list warnings with <code>ToString()</code></li>
<li>4 attributes <code>[Bean]</code>, <code>[BeanReference]</code> etc. for identifying injectables and the
sites where they can be injected plus some ancillary &quot;value&quot; classes such as <code>BeanFactoryArgs</code></li>
<li>4 base classes for users to derive their own attributes
(not-so-simple but can be safely ignored)</li>
<li>3 exception classes - all trivial</li>
<li>There is only one way to define the injectables and injection sites, i.e. by
the use of attributes.  There is no XML alternative or privileged configuration
by code.</li>
<li>The library is lightweight with no non-Microsoft dependencies</li>
</ul>
<h4>Transparency</h4>
<p>Transparency is in evidence through the lack of &quot;magic&quot; such as
AOP (Aspect Oriented Programming) or code generation.  The only
magic is the actual injection using basic reflection.  The
requirement to consistently mark injectables and injection sites
with attributes ([Bean] and [BeanReference] respectively)
is seen as promoting transparency - the coder's
intention is very clear to those who come after.</p>
<p>The requirement for the library user to specify which assemblies
should be subject to injection also supports this aspiration.</p>
<p>The implementation of the library is simple and is described
elsewhere.  This will hopefully allow coders to reason about
the container when tackling edge cases.</p>
<p>The code tries to promote type safety but this is not always
possible - see bean factories, for example.</p>
<h4>Verifiability</h4>
<p>The &quot;configuration-over-convention&quot; approach which provides transparency
also helps with the third aspiration of Verifiability.  By insisting
that he user explicitly states their intention to inject functionality
but the use of <code>[Bean]</code> and <code>[BeanRefererne]</code> attributes we can
provide rich diagnostics so that when things don't work the coder
can investigate in some depth.  The <code>Diagnostics</code> object provides
full details of anomalies discovered when carrying out the injections.</p>
<p>As part of this aspiration there is a more concrete aspiration (for a later version) to
build code analyzers so that much of the validation can be done at
compile time rather than run-time.</p>
<h3>Trade-offs</h3>
<p>Fulfilling such aspirations comes at a cost.</p>
<ul>
<li>Overhead requiring the attribute boilerplate</li>
<li>Absence of hooks for 3rd party frameworks which might otherwise use the container</li>
<li>Possibly some minor performance degradation caused by diagnostic collection</li>
<li>The object model is static - although new objects can be added at program entry points
there is no facility to remove anything.  This will be addressed in the case of
request and session scope objects for web applications in a future version.  In
the mean time where this is necessary beans will have to be created with Prototype scope</li>
<li>There is an absence of convenience/shortcut injections such as allowing values
to be substituted at the point of injection from a configuration file or the environment</li>
<li>A bean reference cannot have parameters which makes creating multiple objects with
the same implementation class but different parameters difficult.</li>
<li>The library is dotnetstandard 2.0 using C# 7.1.</li>
<li>You cannot simply stick a bean reference on some bean
and expect injection to take place.  It must be in the graph produced by
<code>CreateAndInjectDependencies</code>.</li>
</ul>
<h3>Motivation</h3>
<p>The author used <a href="http://spring.io">Java-Spring</a> for 5 years.  I thought Spring was an
excellent, well architected, well documented robust and reliable framework.  It was
particularly suitable for enterprise computing where a consistency of approach in the
team and across teams to core functionality, persistence, web MVC, SOAP, REST,
security, batch processing etc. has a lot to be said for it.  However I found (
albeit picking up the framework in conjunction with a brown-field project which
had been worked on by a variety of developers with a variety of skill levels)
that Spring's ability to do a great deal for the coder behind the scenes was not
my preferred approach.  In particular the AOP involved in enforcing database
transactions was a piece of &quot;magic&quot; too far.  A lot of the design decisions here
are a reaction against the that aspect of Spring.  However I acknowledge the Spring framework as a towering
achievement.</p>
<p><a href="/Simple/userGuide/LimitationsAndGotchas.html">Limitations &amp; Gotchas(or why you will hate me)</a></p>

        </div>
        <div class="col-sm-1"></div>
    </div>
</div>
</body>
</html>